<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Loans - Finanza</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <link href="/img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@500;600;700&family=Open+Sans:wght@400;500&display=swap" rel="stylesheet">  

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="/lib/animate/animate.min.css" rel="stylesheet">
    <link href="/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="/css/style.css" rel="stylesheet">
</head>

<body>
    <!-- Spinner Start -->
    <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;"></div>
    </div>
    <!-- Spinner End -->


    <!-- Navbar Start -->
    <div class="container-fluid fixed-top px-0 wow fadeIn" data-wow-delay="0.1s">
        <div class="top-bar row gx-0 align-items-center d-none d-lg-flex">
            <div class="col-lg-6 px-5 text-start">
                <small><i class="fa fa-map-marker-alt text-primary me-2"></i>123 Street, New York, USA</small>
                <small class="ms-4"><i class="fa fa-clock text-primary me-2"></i>9.00 am - 9.00 pm</small>
            </div>
            <div class="col-lg-6 px-5 text-end">
                <small><i class="fa fa-envelope text-primary me-2"></i>info@example.com</small>
                <small class="ms-4"><i class="fa fa-phone-alt text-primary me-2"></i>+012 345 6789</small>
            </div>
        </div>

        <nav class="navbar navbar-expand-lg navbar-light py-lg-0 px-lg-5 wow fadeIn" data-wow-delay="0.1s">
            <a href="/user/dashboard" class="navbar-brand ms-4 ms-lg-0">
                <img src="/img/logo.png" alt="Finanza" height='50px'>
            </a>
            <button type="button" class="navbar-toggler me-4" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <div class="navbar-nav ms-auto p-4 p-lg-0">
                    <a href="/user/dashboard" class="nav-item nav-link">Dashboard</a>
                    <a href="/user/about" class="nav-item nav-link">About</a>
                    <a href="/user/service" class="nav-item nav-link">Services</a>
                    <div class="nav-item dropdown">
                        <a href="javascript:void(0)" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">Pages</a>
                        <div class="dropdown-menu border-light m-0">
                            <a href="/user/project" class="dropdown-item">Projects</a>
                            <a href="/user/feature" class="dropdown-item">Features</a>
                            <a href="/user/team" class="dropdown-item">Team</a>
                            <a href="/user/testimonial" class="dropdown-item">Testimonial</a>
                        </div>
                    </div>
                    <a href="/user/contact" class="nav-item nav-link">Contact</a>
                    <div class="nav-item dropdown">
                        <a href="javascript:void(0)" class="nav-link dropdown-toggle active" data-bs-toggle="dropdown">My Account</a>
                        <div class="dropdown-menu border-light m-0">
                            <a href="/account" class="dropdown-item">Settings</a>
                            <a href="/logout" class="dropdown-item">Logout</a>
                        </div>
                    </div>
                </div>
                <div class="d-none d-lg-flex ms-2">
                    <a class="tp-btn btn btn-primary py-3 px-5 animated slideInLeft" href="/dashboard">
                        My Dashboard <i class="fa fa-arrow-right"></i>
                    </a>
                </div>
            </div>
        </nav>
    </div>
    <!-- Navbar End -->

    <!-- Page Header Start -->
    <div class="container-fluid page-header mb-5 wow fadeIn" data-wow-delay="0.1s">
        <div class="container">
            <h1 class="display-4 pb-3 animated slideInDown">Loans</h1>
            <nav aria-label="breadcrumb animated slideInDown">
                <ol class="breadcrumb mb-0">
                    <li class="breadcrumb-item"><a class="text-white" href="/user/dashboard">Dashboard</a></li>
                    <li class="breadcrumb-item text-primary active" aria-current="page">Loans</li>
                </ol>
            </nav>
        </div>
    </div>
    <!-- Page Header End -->

    <!-- Content Start -->
    <div class="container-xxl py-5">
        <div class="container">
            <div class="row g-5">
                <div class="col-lg-8 wow fadeInUp" data-wow-delay="0.1s">
                    <h1 class="mb-4">Finanza Loan Profile</h1>
                    <p class="mb-4">Finanza makes installment loans at all of our full-service bank locations, with friendly, helpful loan officers.</p>

                    <h2 class="mb-4 mt-5">Your Current Loans</h2>
                    <div id="current-loans-section">
                        <!-- User's active loans will be loaded here dynamically -->
                        <p>Loading your loans...</p>
                    </div>
                    <p class="mb-4 text-center" id="view-all-loans-link" style="display: none;"><a href="#" class="btn btn-outline-primary">View All Your Loans</a></p>


                    <h2 class="mb-4 mt-5">Apply for a New Loan</h2>
                    <div class="card p-4 mb-4">
                        <form method="post" action="/api/v1/loans/apply">
                            <div class="mb-3">
                                <label for="loanType" class="form-label">Loan Type</label>
                                <select class="form-select" id="loanType" name="loanType" required>
                                    <option selected disabled>Select a Loan Type</option>
                                    <option value="personal">Personal Loan</option>
                                    <option value="auto">Auto Loan</option>
                                    <option value="recreational">Recreational Vehicle Loan</option>
                                    <option value="business">Business Loan</option>
                                    <option value="education">Education Loan</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="loanAmount" class="form-label">Desired Loan Amount</label>
                                <input type="number" class="form-control" id="loanAmount" name="loanAmount" placeholder="e.g., 10000" required min="1000">
                            </div>
                            <div class="mb-3">
                                <label for="loanPurpose" class="form-label">Purpose of Loan</label>
                                <textarea class="form-control" id="loanPurpose" name="loanPurpose" rows="3" placeholder="Briefly describe why you need the loan"></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary w-100 py-3">Submit Loan Application</button>
                        </form>
                    </div>

                    <h2 class="mb-4 mt-5">Understanding Loans</h2>
                    <p class="mb-4">Loans can serve various purposes, such as funding personal expenses, purchasing a home (mortgage loan), buying a car (auto loan), financing education (student loan), or supporting business operations (business loan).</p>
                    <p class="mb-4">Borrowers typically need to submit an application to the bank, providing information about their financial situation, credit history, and the purpose of the loan. The bank evaluates the application and, if approved, determines the terms and conditions of the loan.</p>

                    <h2 class="mb-4 mt-5">Available Loan Products</h2>
                    <ul class="list-unstyled mb-4">
                        <li><i class="fa fa-arrow-right text-primary me-2"></i>Personal Loans for special needs (e.g., vacation, emergency)</li>
                        <li><i class="fa fa-arrow-right text-primary me-2"></i>Auto Loans for new or used vehicles</li>
                        <li><i class="fa fa-arrow-right text-primary me-2"></i>Recreational Vehicle Loans for RVs, boats, etc.</li>
                        <li><i class="fa fa-arrow-right text-primary me-2"></i>Secured Personal Loans (backed by collateral like stocks, CDs)</li>
                        <li><i class="fa fa-arrow-right text-primary me-2"></i>Business Growth Loans</li>
                        <li><i class="fa fa-arrow-right text-primary me-2"></i>Educational Loans</li>
                        <li><i class="fa fa-arrow-right text-primary me-2"></i>Mortgage Loans (Home Loans)</li>
                    </ul>
                </div>
                <div class="col-lg-4 wow fadeInUp" data-wow-delay="0.5s">
                    <div class="bg-light rounded p-4 mb-4">
                        <h4 class="mb-4">Loan Calculator</h4>
                        <div class="mb-3">
                            <label for="calcAmount" class="form-label">Loan Amount</label>
                            <input type="number" class="form-control" id="calcAmount" value="10000">
                        </div>
                        <div class="mb-3">
                            <label for="calcInterest" class="form-label">Annual Interest Rate (%)</label>
                            <input type="number" class="form-control" id="calcInterest" value="5" step="0.1">
                        </div>
                        <div class="mb-3">
                            <label for="calcMonths" class="form-label">Loan Term (Months)</label>
                            <input type="number" class="form-control" id="calcMonths" value="60">
                        </div>
                        <button class="btn btn-primary w-100 py-3" onclick="calculateLoan()">Calculate Payment</button>
                        <h5 class="mt-4">Monthly Payment: <span id="monthlyPayment">$0.00</span></h5>
                        <small>This is an estimate. Actual payments may vary.</small>
                    </div>
                    <div class="bg-light rounded p-4">
                        <h4 class="mb-4">Need Assistance?</h4>
                        <p>Our loan specialists are here to help you find the best loan for your needs.</p>
                        <p><i class="fa fa-phone-alt text-primary me-2"></i>+1 (212) 555-1234</p>
                        <p><i class="fa fa-envelope text-primary me-2"></i>loans@finanza.com</p>
                        <a class="btn btn-secondary w-100 py-3" href="/user/contact">Contact a Loan Officer</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Content End -->

    <!-- Footer Start -->
    <div class="container-fluid bg-dark text-light footer mt-5 py-5 wow fadeIn" data-wow-delay="0.1s">
        <div class="container py-5">
            <div class="row g-5">
                <div class="col-lg-3 col-md-6">
                    <h4 class="text-white mb-4">Our Office</h4>
                    <p class="mb-2"><i class="fa fa-map-marker-alt me-3"></i>123 Main Street, New York, NY 10001</p>
                    <p class="mb-2"><i class="fa fa-phone-alt me-3"></i>+1 (212) 555-1234</p>
                    <p class="mb-2"><i class="fa fa-envelope me-3"></i>contact@finanza.com</p>
                    <div class="d-flex pt-2">
                        <a class="btn btn-square btn-outline-light rounded-circle me-2" href=""><i class="fab fa-twitter"></i></a>
                        <a class="btn btn-square btn-outline-light rounded-circle me-2" href=""><i class="fab fa-facebook-f"></i></a>
                        <a class="btn btn-square btn-outline-light rounded-circle me-2" href=""><i class="fab fa-youtube"></i></a>
                        <a class="btn btn-square btn-outline-light rounded-circle me-2" href=""><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h4 class="text-white mb-4">Services</h4>
                    <a class="btn btn-link" href="/user/financial-planning">Financial Planning</a>
                    <a class="btn btn-link" href="/user/investments">Cash Investment</a>
                    <a class="btn btn-link" href="/user/service">Financial Consultancy</a>
                    <a class="btn btn-link" href="/user/loans">Business Loans</a>
                    <a class="btn btn-link" href="/user/business-analysis">Business Analysis</a>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h4 class="text-white mb-4">Quick Links</h4>
                    <a class="btn btn-link" href="/user/about">About Us</a>
                    <a class="btn btn-link" href="/user/contact">Contact Us</a>
                    <a class="btn btn-link" href="/user/service">Our Services</a>
                    <a class="btn btn-link" href="#">Terms & Condition</a>
                    <a class="btn btn-link" href="">Support</a>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h4 class="text-white mb-4">Newsletter</h4>
                    <p>Stay updated with our latest news and insights. Subscribe to our newsletter.</p>
                    <div class="position-relative w-100">
                        <input class="form-control bg-white border-0 w-100 py-3 ps-4 pe-5" type="text" placeholder="Your email">
                        <button type="button" class="btn btn-primary py-2 position-absolute top-0 end-0 mt-2 me-2">SignUp</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer End -->


    <!-- Copyright Start -->
    <div class="container-fluid copyright py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    &copy; <a class="border-bottom" href="#">Finanza</a>, All Right Reserved.
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <!--/*** This template is free as long as you keep the footer author’s credit link/attribution link/backlink. If you'd like to use the template without the footer author’s credit link/attribution link/backlink, you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". Thank you for your support. ***/-->
                    Designed By <a class="border-bottom" href="https://htmlcodex.com">HTML Codex</a>
                </div>
            </div>
        </div>
    </div>
    <!-- Copyright End -->


    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square rounded-circle back-to-top"><i class="bi bi-arrow-up"></i></a>


    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/lib/wow/wow.min.js"></script>
    <script src="/lib/easing/easing.min.js"></script>
    <script src="/lib/waypoints/waypoints.min.js"></script>
    <script src="/lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="/lib/counterup/counterup.min.js"></script>

    <!-- Template Javascript -->
    <script src="/js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            async function fetchUserLoans() {
                const loansSection = document.getElementById('current-loans-section');
                try {
                    const response = await fetch('/api/v1/loans/', { credentials: 'include' });
                    if (!response.ok) throw new Error('Failed to fetch loans.');
                    const loans = await response.json();

                    loansSection.innerHTML = '';

                    if (!loans || loans.length === 0) {
                        loansSection.innerHTML = '<p>You have no active loans at the moment.</p>';
                        return;
                    }

                    loans.forEach(loan => {
                        const loanCard = `
                            <div class="card mb-4">
                                <div class="card-body">
                                    <h5 class="card-title">Loan #${loan.id}</h5>
                                    <p class="card-text"><strong>Amount:</strong> $${(loan.amount || 0).toFixed(2)}</p>
                                    <p class="card-text"><strong>Interest Rate:</strong> ${loan.interest_rate || 'N/A'}%</p>
                                    <p class="card-text"><strong>Term:</strong> ${loan.term_months || 'N/A'} months</p>
                                    <p class="card-text"><strong>Status:</strong> <span class="badge bg-info">${loan.status || 'Active'}</span></p>
                                    <p class="card-text"><strong>Date Created:</strong> ${loan.created_at ? new Date(loan.created_at).toLocaleDateString() : 'N/A'}</p>
                                    <button class="btn btn-primary btn-sm me-2">Make a Payment</button>
                                    <button class="btn btn-secondary btn-sm">View Details</button>
                                </div>
                            </div>
                        `;
                        loansSection.innerHTML += loanCard;
                    });

                    if (loans.length > 2) { // Example condition to show "View All"
                        document.getElementById('view-all-loans-link').style.display = 'block';
                    }

                } catch (error) {
                    loansSection.innerHTML = '<p class="text-danger">Could not load your loan information. Please try again later.</p>';
                    console.error('Error fetching loans:', error);
                }
            }

            fetchUserLoans();
        });
    </script>
    <script>
        function calculateLoan() {
            const amount = parseFloat(document.getElementById('calcAmount').value);
            const interest = parseFloat(document.getElementById('calcInterest').value) / 100 / 12; // Monthly interest rate
            const months = parseFloat(document.getElementById('calcMonths').value);

            if (isNaN(amount) || isNaN(interest) || isNaN(months) || amount <= 0 || interest < 0 || months <= 0) {
                document.getElementById('monthlyPayment').innerText = "Invalid Input";
                return;
            }

            let monthlyPayment = 0;
            if (interest === 0) {
                monthlyPayment = amount / months;
            } else {
                monthlyPayment = (amount * interest) / (1 - Math.pow(1 + interest, -months));
            }
            
            document.getElementById('monthlyPayment').innerText = `$${monthlyPayment.toFixed(2)}`;
        }

        // Calculate on page load with default values
        document.addEventListener('DOMContentLoaded', calculateLoan);
    </script>
</body>

</html>